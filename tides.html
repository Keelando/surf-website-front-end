<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Tide Conditions | Salish Sea Marine Forecasts</title>

  <meta name="description" content="Real-time tide observations and predictions for Salish Sea stations including Point Atkinson, Vancouver, and Strait of Georgia. Updated every 30 minutes from DFO sources." />
  <meta name="keywords" content="Salish Sea, tides, tide predictions, Point Atkinson, Vancouver tides, Strait of Georgia, DFO, marine forecast, BC coast tides" />
  <meta name="author" content="Salish Sea Wave Conditions Project" />
  <meta name="robots" content="index, follow" />

  <link rel="canonical" href="https://halibutbank.ca/tides.html" />
  <link rel="stylesheet" href="/assets/css/style-v3.css" />
  <link rel="stylesheet" href="/assets/css/nav-tide-styles-v3.css" />
  <link rel="stylesheet" href="/assets/css/warning-banner-v3.css" />
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>

<body>
  <!-- Warning Banner Container -->
  <div id="warning-banner-container"></div>

  <!-- Navigation -->
  <nav class="main-nav">
    <a href="/" class="nav-link">Buoys</a>
    <a href="/tides.html" class="nav-link active">Tides</a>
    <a href="/forecasts.html" class="nav-link">Forecasts</a>
    <a href="/storm_surge.html" class="nav-link">Storm Surge</a>
  </nav>

  <header>
    <h1>Salish Sea Tide Conditions</h1>
  </header>

  <main class="tide-main-content">
    
    <!-- Station Selector -->
    <section class="tide-selector-section">
      <label for="tide-station-select" style="font-size: 1.2rem; font-weight: bold; margin-right: 1rem;">
        Select Tide Station:
      </label>
      <select id="tide-station-select" style="padding: 0.75rem; font-size: 1rem; min-width: 250px;">
        <option value="">Loading stations...</option>
      </select>
    </section>

    <!-- Current Conditions Card -->
    <section id="tide-current-section" class="tide-card" style="display: none;">
      <h2 id="station-name">Station Name</h2>

      <!-- Station Metadata -->
      <div id="station-metadata" class="station-metadata">
        <!-- Populated by JS -->
      </div>

      <!-- Current Observation -->
      <div class="tide-data-group">
        <h3>Current Observation</h3>
        <div id="current-observation" class="tide-value">
          <p>Loading...</p>
        </div>
      </div>

      <!-- Current Prediction -->
      <div class="tide-data-group">
        <h3>Current Prediction</h3>
        <div id="current-prediction" class="tide-value">
          <p>Loading...</p>
        </div>
      </div>

      <!-- Storm Surge -->
      <div class="tide-data-group">
        <h3>Predicted Storm Surge</h3>
        <div id="storm-surge" class="tide-value">
          <p>Loading...</p>
        </div>
      </div>

      <!-- High/Low Events -->
      <div class="tide-data-group">
        <h3>Today's High & Low Tides</h3>
        <div class="data-table">
          <table id="highlow-table">
            <thead>
              <tr>
                <th>Time (Pacific)</th>
                <th>Height</th>
                <th>Type</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="3">Loading...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Tide Prediction Chart -->
      <div class="tide-data-group">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
          <h3 style="margin: 0;">Tide & Water Level Forecast</h3>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <button id="prev-day-btn" style="padding: 0.5rem 1rem; font-size: 1.2rem; cursor: pointer; border: 1px solid #ccc; background: white; border-radius: 4px;" title="Previous day">◀</button>
            <span id="chart-date-label" style="font-weight: bold; min-width: 150px; text-align: center;">Today</span>
            <button id="next-day-btn" style="padding: 0.5rem 1rem; font-size: 1.2rem; cursor: pointer; border: 1px solid #ccc; background: white; border-radius: 4px;" title="Next day">▶</button>
          </div>
        </div>
        <div id="tide-chart" style="width: 100%; height: 500px;"></div>
      </div>
    </section>

    <!-- Loading/Error Messages -->
    <div id="tide-loading" style="text-align: center; padding: 2rem; color: #666;">
      <p>Select a tide station to view current conditions and predictions.</p>
    </div>

    <div id="tide-error" style="display: none; text-align: center; padding: 2rem; color: #e53935;">
      <p>Error loading tide data. Please try again later.</p>
    </div>

  </main>

  <!-- About Section -->
  <section class="about-section">
    <h3>About Tide Data</h3>
    <p>
      <strong>Tide observations</strong> are updated every 30 minutes from DFO (Fisheries and Oceans Canada)
      water level stations. <strong>Astronomical tide predictions</strong> are based on harmonic
      constituents and are updated daily.
    </p>
    <p>
      <strong>Total Water Level</strong> combines astronomical tides with storm surge forecasts from
      Environment Canada's GDSPS model. Storm surge is the elevation of water caused by wind stress
      and atmospheric pressure changes during weather systems.
    </p>
    <p>
      <strong>Chart Legend:</strong><br>
      • <span style="color: #0077be;">━━</span> Astronomical Tide (predicted)<br>
      • <span style="color: #43a047;">●</span> Observation (real-time, today only)<br>
      • <span style="color: #ff9800;">━━</span> Storm Surge (forecast anomaly)<br>
      • <span style="color: #9c27b0; font-weight: bold;">━━</span> Total Water Level (tide + surge)
    </p>
    <p>
      High and low tide times represent the predicted maximum and minimum water levels for
      the current day in Pacific Time. Use the arrow buttons to view forecasts for the next 2 days.
    </p>
  </section>

  <!-- Navigation (Bottom) -->
  <nav class="main-nav">
    <a href="/" class="nav-link">Buoys</a>
    <a href="/tides.html" class="nav-link active">Tides</a>
    <a href="/forecasts.html" class="nav-link">Forecasts</a>
    <a href="/storm_surge.html" class="nav-link">Storm Surge</a>
  </nav>

  <footer>
    <p>Please independently verify this data and do not base recreational activities around this information.</p>
    <p><small>Auto-updated from DFO IWLS API | <span id="timestamp">Loading...</span></small></p>
  </footer>

  <script src="assets/js/warning-banner.js"></script>
  <script src="assets/js/tides.js"></script>
</body>
</html>