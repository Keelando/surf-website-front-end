<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Storm Surge Forecasts | Salish Sea Wave Conditions</title>

  <meta name="description" content="10-day storm surge forecasts and hindcast analysis for the Salish Sea region from Environment Canada GDSPS model." />
  <meta name="keywords" content="storm surge, water level forecast, GDSPS, Salish Sea, tide forecast, Environment Canada, coastal flooding" />
  <meta name="author" content="Salish Sea Wave Conditions Project" />
  <meta name="robots" content="index, follow" />

  <link rel="canonical" href="https://halibutbank.ca/storm_surge.html" />
  <link rel="stylesheet" href="/assets/css/style-v4.css" />
  <link rel="stylesheet" href="/assets/css/nav-tide-styles-v4.css" />
  <link rel="stylesheet" href="/assets/css/warning-banner-v4.css" />

  <style>
    .storm-surge-content {
      max-width: 1400px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .section-container {
      background: #fff;
      border: 1px solid #e0e7ee;
      border-radius: 8px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .section-container h2 {
      margin-top: 0;
      color: #2c5282;
      border-bottom: 3px solid #4299e1;
      padding-bottom: 0.5rem;
      margin-bottom: 1.5rem;
    }

    .station-selector {
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .station-selector label {
      font-weight: 600;
      margin-right: 0.5rem;
      color: #2d3748;
    }

    .station-selector select {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border: 1px solid #cbd5e0;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }

    .station-indicator {
      margin-left: 1rem;
      color: #0077be;
      font-weight: 500;
    }

    .chart-container {
      width: 100%;
      height: 500px;
      margin-bottom: 1rem;
    }

    .metadata-display {
      margin-top: 1rem;
      padding: 1rem;
      background: #f7fafc;
      border-radius: 4px;
      font-size: 0.9rem;
      color: #4a5568;
      line-height: 1.8;
    }

    .info-box {
      background: #ebf8ff;
      border-left: 4px solid #4299e1;
      padding: 1rem 1.5rem;
      margin: 1.5rem 0;
      border-radius: 4px;
    }

    .info-box h3 {
      margin: 0 0 0.5rem 0;
      color: #2c5282;
      font-size: 1rem;
    }

    .info-box p {
      margin: 0;
      color: #2d3748;
      line-height: 1.6;
    }

    .loading-state {
      text-align: center;
      padding: 3rem 1rem;
      color: #718096;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .section-container {
        padding: 1.5rem 1rem;
      }

      .chart-container {
        height: 400px;
      }
    }

    header {
      margin-bottom: 0;
    }

    .site-tagline {
      background: linear-gradient(to bottom, rgba(224, 242, 255, 0.5), rgba(224, 242, 255, 0.8));
      text-align: center;
      font-size: 1rem;
      font-style: italic;
      color: #2c5282;
      padding: 1rem 1.5rem;
      margin: 0;
      border-bottom: 1px solid rgba(66, 153, 225, 0.2);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    @media (max-width: 768px) {
      .site-tagline {
        font-size: 0.9rem;
        padding: 0.85rem 1rem;
      }
    }
  </style>
</head>

<body>
  <!-- Warning Banner Container -->
  <div id="warning-banner-container" aria-live="polite" role="alert"></div>

  <!-- Navigation -->
  <nav class="main-nav">
    <a href="/" class="nav-link">Buoys</a>
    <a href="/tides.html" class="nav-link">Tides</a>
    <a href="/forecasts.html" class="nav-link">Forecasts</a>
    <a href="/storm_surge.html" class="nav-link active">Storm Surge</a>
  </nav>

  <header>
    <h1>Storm Surge Forecasts</h1>
  </header>

  <div class="site-tagline">
    GDSPS 10-Day Forecasts & Historical Analysis
  </div>

  <main class="storm-surge-content">
    <!-- Current Forecast Section -->
    <section class="section-container">
      <h2>10-Day Storm Surge Forecast</h2>

      <div class="info-box">
        <h3>What is Storm Surge?</h3>
        <p>
          Storm surge is the abnormal rise or fall in water level caused by weather patterns (wind, atmospheric pressure).
          Values shown are <strong>relative to predicted astronomical tide</strong>. Positive values indicate higher water than predicted,
          negative values indicate lower water than predicted. Total water level = Predicted tide + Storm surge.
        </p>
        <p style="margin-top: 0.75rem;">
          Forecasts generated by Environment Canada's <strong>GDSPS</strong> (Global Deterministic Storm Surge Prediction System) model, which runs 4 times daily (00Z, 06Z, 12Z, 18Z).
        </p>
      </div>

      <div class="station-selector">
        <label for="forecast-station-select">Select Station:</label>
        <select id="forecast-station-select">
          <!-- Options populated by JavaScript -->
        </select>
        <a href="javascript:void(0)" onclick="showSelectedForecastSurgeOnMap()" style="margin-left: 1rem; padding: 0.5rem 1rem; background: #0077be; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem; display: inline-block;">Show on Map</a>
        <span id="forecast-station-indicator" class="station-indicator"></span>
      </div>

      <!-- Peak Surge Display -->
      <div id="peak-surge-display" style="display: none; margin: 0.75rem auto; padding: 0.6rem 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 6px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.25); max-width: 600px;">
        <div style="color: white; text-align: center; font-size: 0.7rem; font-weight: 600; opacity: 0.9; margin-bottom: 0.5rem; letter-spacing: 0.3px;">⚡ Peak Forecasts</div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.75rem; color: white;">
          <!-- Today Peak -->
          <div style="text-align: center; padding: 0.4rem;">
            <div style="font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.85; margin-bottom: 0.3rem;">Today</div>
            <div id="peak-today-value" style="font-size: 1.4rem; font-weight: bold; margin-bottom: 0.15rem;">—</div>
            <div id="peak-today-time" style="opacity: 0.8; font-size: 0.75rem;">—</div>
          </div>
          <!-- 3-Day Peak -->
          <div style="text-align: center; padding: 0.4rem; border-left: 1px solid rgba(255,255,255,0.2);">
            <div style="font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.85; margin-bottom: 0.3rem;">3 Days</div>
            <div id="peak-3day-value" style="font-size: 1.4rem; font-weight: bold; margin-bottom: 0.15rem;">—</div>
            <div id="peak-3day-time" style="opacity: 0.8; font-size: 0.75rem;">—</div>
          </div>
          <!-- 7-Day Peak -->
          <div style="text-align: center; padding: 0.4rem; border-left: 1px solid rgba(255,255,255,0.2);">
            <div style="font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; opacity: 0.85; margin-bottom: 0.3rem;">7 Days</div>
            <div id="peak-7day-value" style="font-size: 1.4rem; font-weight: bold; margin-bottom: 0.15rem;">—</div>
            <div id="peak-7day-time" style="opacity: 0.8; font-size: 0.75rem;">—</div>
          </div>
        </div>
      </div>

      <div id="forecast-chart" class="chart-container"></div>
      <div id="forecast-metadata" class="metadata-display"></div>
    </section>

    <!-- Hindcast Section -->
    <section class="section-container">
      <h2>Forecast Accuracy Analysis (Hindcast)</h2>

      <div class="info-box">
        <h3>About Hindcast Data</h3>
        <p>
          This chart shows storm surge predictions made <strong>48 hours in advance</strong> and compares them to more recent forecasts
          or actual conditions. This helps evaluate forecast accuracy and identify patterns in model performance.
          Data is collected daily from the 18Z model run (closest to noon Pacific time).
        </p>
      </div>

      <div class="station-selector">
        <label for="hindcast-station-select">Select Station:</label>
        <select id="hindcast-station-select">
          <!-- Options populated by JavaScript -->
        </select>
        <a href="javascript:void(0)" onclick="showSelectedHindcastSurgeOnMap()" style="margin-left: 1rem; padding: 0.5rem 1rem; background: #0077be; color: white; text-decoration: none; border-radius: 4px; font-size: 0.9rem; display: inline-block;">Show on Map</a>
        <span id="hindcast-station-indicator" class="station-indicator"></span>
      </div>

      <div id="hindcast-chart" class="chart-container"></div>
      <div id="hindcast-metadata" class="metadata-display"></div>
    </section>

    <!-- Model Information -->
    <section class="section-container">
      <h2>Model Information</h2>
      <p><strong>Model:</strong> GDSPS (Global Deterministic Storm Surge Prediction System)</p>
      <p><strong>Provider:</strong> Environment and Climate Change Canada</p>
      <p><strong>Resolution:</strong> 15 km horizontal resolution</p>
      <p><strong>Update Frequency:</strong> 4 times daily (00Z, 06Z, 12Z, 18Z)</p>
      <p><strong>Forecast Horizon:</strong> 10 days (240 hours)</p>
      <p style="margin-top: 1rem; font-size: 0.9rem; color: #718096;">
        More information: <a href="https://eccc-msc.github.io/open-data/msc-data/nwp_gdsps/readme_gdsps_en/" target="_blank" style="color: #4299e1;">GDSPS Documentation</a>
      </p>
    </section>
  </main>

  <!-- Navigation (Bottom) -->
  <nav class="main-nav">
    <a href="/" class="nav-link">Buoys</a>
    <a href="/tides.html" class="nav-link">Tides</a>
    <a href="/forecasts.html" class="nav-link">Forecasts</a>
    <a href="/storm_surge.html" class="nav-link active">Storm Surge</a>
  </nav>

  <footer>
    <p>Storm surge forecasts provided by Environment Canada GDSPS model. Please independently verify this data and do not base activities solely on this information.</p>
    <p><small>Auto-updated from Environment Canada GeoMet | <span id="timestamp">Loading...</span></small></p>
    <p style="margin-top: 1rem;">
      <a href="https://github.com/Keelando/surf-website" target="_blank" rel="noopener noreferrer" class="github-link" style="color: white; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem;" aria-label="View project on GitHub">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;" aria-hidden="true">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        View on GitHub
      </a>
    </p>
  </footer>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
  <!-- Load logger first for global availability -->
  <script src="/assets/js/logger.js?v=20251117"></script>
  <script src="/assets/js/warning-banner.js?v=20251117"></script>
  <script src="/assets/js/chart-utils-v4.js?v=20251117"></script>
  <script src="/assets/js/storm_surge_page.js?v=20251117"></script>
</body>
</html>
